    double l = 2 * sin(M_PI / num_v);
    if (l > sigma) {
        throw std::runtime_error("Invalid geometry: vertex spacing larger than sigma");
    }
    double polygon_area = 0.5 * num_v * sin(2 * M_PI / num_v);
    double vertices_area = (1 - ((num_v - 2) / (2 * num_v))) * M_PI * num_v * sigma * sigma / 4;
    double vertex_overlaps = 0.5 * num_v * (sigma * sigma * acos(l / sigma) - l * std::sqrt(sigma * sigma - l * l));

    return polygon_area + vertices_area - vertex_overlaps;
